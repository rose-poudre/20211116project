<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UAs-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1"
      crossorigin="anonymous"
    />
    <link
      href="https://use.fontawesome.com/releases/v5.6.1/css/all.css"
      rel="stylesheet"
    />
    <!-- <link rel="stylesheet" type="text/css" href="css/main.css" />
     <link rel="stylesheet" href="css/foodinput.css" /> -->
    <link rel="stylesheet" href="./css/modal.css" />
  </head>
  <body>
    <section>
      <table border="1">
        <tr>
          <th>日付</th>
          <th>体重</th>
        </tr>
        <tr id="memo">
          <td>
            <input type="date" id="date1" />
          </td>
          <td>
            <input type="number" id="today_weight1" />
          </td>
        </tr>

        <tr id="memo2">
          <td>
            <input type="date" id="date2" />
          </td>
          <td>
            <input type="number" id="today_weight2" />
          </td>
        </tr>
        <tr id="memo3">
          <td>
            <input type="date" id="date3" />
          </td>
          <td>
            <input type="number" id="today_weight3" />
          </td>
        </tr>
        <tr id="memo4">
          <td>
            <input type="date" id="date4" />
          </td>
          <td>
            <input type="number" id="today_weight4" />
          </td>
        </tr>
        <tr id="memo5">
          <td>
            <input type="date" id="date5" />
          </td>
          <td>
            <input type="number" id="today_weight5" />
          </td>
        </tr>
        <tr id="memo6">
          <td>
            <input type="date" id="date6" />
          </td>
          <td>
            <input type="number" id="today_weight6" />
          </td>
        </tr>
        <tr id="memo7">
          <td>
            <input type="date" id="date7" />
          </td>
          <td>
            <input type="number" id="today_weight7" />
          </td>
        </tr>
      </table>
      <ul>
        <li id="save">Save</li>
        <li id="clear">Clear</li>
      </ul>
    </section>

    <!-- グラフ化 -->
    <canvas id="ex_chart"></canvas>

    <!-- モーダルボタン -->
    <button class="js-open button-open">体重入力</button>
    <!-- モーダルボタン終了 -->

    <!-- オーバーレイ -->
    <div id="overlay" class="overlay"></div>
    <!-- モーダルウィンドウ -->
    <div class="modal-window">
      <div class="number">
       <p id="w"></p>
        <p>kg</p>
      </div>

      <button onclick="append( '1' )">1</button>
      <button onclick="append( '2' )">2</button>
      <button onclick="append( '3' )">3</button><br />
      <button onclick="append( '4' )">4</button>
      <button onclick="append( '5' )">5</button>
      <button onclick="append( '6' )">6</button><br />
      <button onclick="append( '7' )">7</button>
      <button onclick="append( '8' )">8</button>
      <button onclick="append( '9' )">9</button><br />
      <button onclick="append( '0' )">0</button>
      <button onclick="append( '.' )">.</button>
      <button onclick="document.querySelector( 'input' ).value ='' ">C</button
      ><br />

      <button id="ok">OK</button>

      <!-- 閉じるボタン -->
      <button class="js-close button-close">Close</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <script>
      //inputタグを更新する関数
      function update(number) {
        document.querySelector("input").value = number;
      }

      //数字ボタンが押されたので数字を後ろに追加する
      function append(number) {
        document.querySelector("input").value += number;
      }

      //[=]ボタンが押されたら計算
      function calc() {
        const v = document.querySelector("input").value;
        const f = new Function("return" + v);
        update(f().toString());
      }

      $(function () {
        $(".modal-window").hide();
        $(".js-open").click(function () {
          $("#overlay, .modal-window").fadeIn();
        });
        $(".js-close").click(function () {
          $("#overlay, .modal-window").fadeOut();
        });
      });

      //////////////////////// 保存/////////////////////
      $("#save").on("click", function () {
        // テキストエリアの内容取得
        const date = $("#date1").val();
        const weight = $("#today_weight1").val();
        const hole = {
          date: date,
          weight: weight,
        };

        const jsonData = JSON.stringify(hole);
        // console.log(jsonData);
        // ローカルストレージのmemoに保存
        localStorage.setItem("memo", jsonData);
      });
      ///////////////////// 削除/////////////////////
      $("#clear").on("click", function () {
        // ローカルストレージのmemo内容削除
        localStorage.removeItem("memo");
        // テキストエリア空白で上書き
        $("#date1").val("");
        $("#today_weight1").val("");
      });
      // ローカルストレージにmemoの内容あるか確認
      if (localStorage.getItem("memo")) {
        // ローカルストレージのmemoを取得
        const jsonData = localStorage.getItem("memo");
        const hole = JSON.parse(jsonData);
        // console.log(hole);
        // 取得した内容でテキストエリアを上書き
        $("#date1").val(hole.date);
        $("#today_weight1").val(hole.weight);
      }

      //////////////////////// 保存/////////////////////
      $("#save").on("click", function () {
        // テキストエリアの内容取得
        const date = $("#date2").val();
        const weight = $("#today_weight2").val();

        const hole = {
          date: date,
          weight: weight,
        };
        // console.log(hole);
        const jsonData = JSON.stringify(hole);
        // console.log(jsonData);
        // ローカルストレージのmemoに保存
        localStorage.setItem("memo2", jsonData);
      });
      ///////////////////// 削除/////////////////////
      $("#clear").on("click", function () {
        // ローカルストレージのmemo内容削除
        localStorage.removeItem("memo2");
        // テキストエリア空白で上書き
        $("#date2").val("");
        $("#today_weight2").val("");
      });
      // ローカルストレージにmemoの内容あるか確認
      if (localStorage.getItem("memo2")) {
        // ローカルストレージのmemoを取得
        const jsonData = localStorage.getItem("memo2");
        const hole = JSON.parse(jsonData);
        // console.log(hole);
        // 取得した内容でテキストエリアを上書き
        $("#date2").val(hole.date);
        $("#today_weight2").val(hole.weight);
      }
      //////////////////////// 保存/////////////////////
      $("#save").on("click", function () {
        // テキストエリアの内容取得
        const date = $("#date3").val();
        const weight = $("#today_weight3").val();

        const hole = {
          date: date,
          weight: weight,
        };
        // console.log(hole);
        const jsonData = JSON.stringify(hole);
        // console.log(jsonData);
        // ローカルストレージのmemoに保存
        localStorage.setItem("memo3", jsonData);
      });
      ///////////////////// 削除/////////////////////
      $("#clear").on("click", function () {
        // ローカルストレージのmemo内容削除
        localStorage.removeItem("memo3");
        // テキストエリア空白で上書き
        $("#date3").val("");
        $("#today_weight3").val("");
      });
      // ローカルストレージにmemoの内容あるか確認
      if (localStorage.getItem("memo3")) {
        // ローカルストレージのmemoを取得
        const jsonData = localStorage.getItem("memo3");
        const hole = JSON.parse(jsonData);
        // console.log(hole);
        // 取得した内容でテキストエリアを上書き
        $("#date3").val(hole.date);
        $("#today_weight3").val(hole.weight);
      }
      //////////////////////// 保存/////////////////////
      $("#save").on("click", function () {
        // テキストエリアの内容取得
        const date = $("#date4").val();
        const weight = $("#today_weight4").val();

        const hole = {
          date: date,
          weight: weight,
        };
        // console.log(hole);
        const jsonData = JSON.stringify(hole);
        // console.log(jsonData);
        // ローカルストレージのmemoに保存
        localStorage.setItem("memo4", jsonData);
      });
      ///////////////////// 削除/////////////////////
      $("#clear").on("click", function () {
        // ローカルストレージのmemo内容削除
        localStorage.removeItem("memo4");
        // テキストエリア空白で上書き
        $("#date4").val("");
        $("#today_weight4").val("");
      });
      // ローカルストレージにmemoの内容あるか確認
      if (localStorage.getItem("memo4")) {
        // ローカルストレージのmemoを取得
        const jsonData = localStorage.getItem("memo4");
        const hole = JSON.parse(jsonData);
        // console.log(hole);
        // 取得した内容でテキストエリアを上書き
        $("#date4").val(hole.date);
        $("#today_weight4").val(hole.weight);
      }
      //////////////////////// 保存/////////////////////
      $("#save").on("click", function () {
        // テキストエリアの内容取得
        const date = $("#date5").val();
        const weight = $("#today_weight5").val();

        const hole = {
          date: date,
          weight: weight,
        };
        // console.log(hole);
        const jsonData = JSON.stringify(hole);
        // console.log(jsonData);
        // ローカルストレージのmemoに保存
        localStorage.setItem("memo5", jsonData);
      });
      ///////////////////// 削除/////////////////////
      $("#clear").on("click", function () {
        // ローカルストレージのmemo内容削除
        localStorage.removeItem("memo5");
        // テキストエリア空白で上書き
        $("#date5").val("");
        $("#today_weight5").val("");
      });
      // ローカルストレージにmemoの内容あるか確認
      if (localStorage.getItem("memo5")) {
        // ローカルストレージのmemoを取得
        const jsonData = localStorage.getItem("memo5");
        const hole = JSON.parse(jsonData);
        // console.log(hole);
        // 取得した内容でテキストエリアを上書き
        $("#date5").val(hole.date);
        $("#today_weight5").val(hole.weight);
      }
      //////////////////////// 保存/////////////////////
      $("#save").on("click", function () {
        // テキストエリアの内容取得
        const date = $("#date6").val();
        const weight = $("#today_weight6").val();

        const hole = {
          date: date,
          weight: weight,
        };
        // console.log(hole);
        const jsonData = JSON.stringify(hole);
        // console.log(jsonData);
        // ローカルストレージのmemoに保存
        localStorage.setItem("memo6", jsonData);
      });
      ///////////////////// 削除/////////////////////
      $("#clear").on("click", function () {
        // ローカルストレージのmemo内容削除
        localStorage.removeItem("memo6");
        // テキストエリア空白で上書き
        $("#date6").val("");
        $("#today_weight6").val("");
      });
      // ローカルストレージにmemoの内容あるか確認
      if (localStorage.getItem("memo6")) {
        // ローカルストレージのmemoを取得
        const jsonData = localStorage.getItem("memo6");
        const hole = JSON.parse(jsonData);
        // console.log(hole);
        // 取得した内容でテキストエリアを上書き
        $("#date6").val(hole.date);
        $("#today_weight6").val(hole.weight);
      }
      //////////////////////// 保存/////////////////////
      $("#save").on("click", function () {
        // テキストエリアの内容取得
        const date = $("#date7").val();
        const weight = $("#today_weight7").val();

        const hole = {
          date: date,
          weight: weight,
        };
        // console.log(hole);
        const jsonData = JSON.stringify(hole);
        // console.log(jsonData);
        // ローカルストレージのmemoに保存
        localStorage.setItem("memo7", jsonData);
      });
      ///////////////////// 削除/////////////////////
      $("#clear").on("click", function () {
        // ローカルストレージのmemo内容削除
        localStorage.removeItem("memo7");
        // テキストエリア空白で上書き
        $("#date7").val("");
        $("#today_weight7").val("");
      });
      // ローカルストレージにmemoの内容あるか確認
      if (localStorage.getItem("memo7")) {
        // ローカルストレージのmemoを取得
        const jsonData = localStorage.getItem("memo7");
        const hole = JSON.parse(jsonData);
        // console.log(hole);
        // 取得した内容でテキストエリアを上書き
        $("#date7").val(hole.date);
        $("#today_weight7").val(hole.weight);
      }

      ////////////////////////グラフ//////////////////////
      var ctx = document.getElementById("ex_chart");

      var data = {
        labels: [
          $("#date1").val(),
          $("#date2").val(),
          $("#date3").val(),
          $("#date4").val(),
          $("#date5").val(),
        ],
        datasets: [
          {
            label: "体重記録",
            data: [
              $("#today_weight1").val(),
              $("#today_weight2").val(),
              $("#today_weight3").val(),
              $("#today_weight4").val(),
              $("#today_weight5").val(),
            ],
            borderColor: "rgba(255, 100, 100, 1)",
            lineTension: 0,
            fill: false,
            borderWidth: 3,
          },
        ],
      };

      var options = {
        scales: {
          yAxes: [
            {
              ticks: {
                min: 40,
                max: 100,
                stepSize: 10,
                beginAtZero: true,
              },
            },
          ],
        },
      };

      var ex_chart = new Chart(ctx, {
        type: "line",
        data: data,
        options: options,
      });
      //////////////////////////////////////////////
    </script>
  </body>
</html>
